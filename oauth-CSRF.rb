## issue with "curl -H 'Authorization: Bearer [TOKEN]' [RESOURCE_SERVER]/api/keys --dump-header -"

require 'oauth2'

callback = "<http://yourIPaddr>"
app_id = "<application ID>"

secret = "<secret>"
client = OAuth2::Client.new(app_id, secret, site: "<victim site>")
puts client.auth_code.authorize_url(redirect_uri: callback)
exit


code="[CODE]"
access = client.auth_code.get_token( code, redirect_uri: callback)
access.get("/api/user").parsed

puts access.token  
